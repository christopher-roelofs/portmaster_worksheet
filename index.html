<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Database</title>
    <!-- Firebase App (the core Firebase SDK) -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js"></script>
    <!-- Firestore (Firebase database) -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore.js"></script>
</head>
<body>
    <h1>Game Database Entry</h1>

    <form id="gameForm">
        <label for="gameName">Game Name:</label>
        <input type="text" id="gameName" required><br><br>

        <label for="gameURL">Game URL:</label>
        <input type="url" id="gameURL" required><br><br>

        <label for="gameComments">Comments:</label>
        <textarea id="gameComments"></textarea><br><br>

        <input type="submit" value="Add Game">
    </form>

    <h2>Existing Games:</h2>
    <ul id="gameList">
        <!-- Existing game entries will be populated here -->
    </ul>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            // Initialize Firebase
            const firebaseConfig = {
                apiKey: "AIzaSyDaZcun82L8Y9ygM4YftjnVktfHR_RYa5k",
                authDomain: "portmaster-worksheet.firebaseapp.com",
                projectId: "portmaster-worksheet",
                storageBucket: "portmaster-worksheet.appspot.com",
                messagingSenderId: "446872253270",
                appId: "1:446872253270:web:26346a4a16ce4878279cf7"
            };
            const app = firebase.initializeApp(firebaseConfig);
            const db = firebase.firestore(app);

            // Fetch existing games from Firebase and display
            function fetchGames() {
                db.collection("games").get().then((querySnapshot) => {
                    const gameList = document.getElementById('gameList');
                    gameList.innerHTML = "";  // Clear the list first
                    querySnapshot.forEach((doc) => {
                        const gameData = doc.data();
                        gameList.innerHTML += `<li><strong>${gameData.name}</strong> - <a href="${gameData.url}" target="_blank">${gameData.url}</a><br>${gameData.comments || ""}</li>`;
                    });
                });
            }

            // Add game details to Firebase on form submission
            document.getElementById('gameForm').addEventListener('submit', function(e) {
                e.preventDefault();

                var gameName = document.getElementById('gameName').value;
                var gameURL = document.getElementById('gameURL').value;
                var gameComments = document.getElementById('gameComments').value;

                // Add a new document to the "games" collection
                db.collection("games").add({
                    name: gameName,
                    url: gameURL,
                    comments: gameComments
                })
                .then(function() {
                    console.log("Document successfully written!");
                    // Clear the form
                    document.getElementById('gameForm').reset();
                    // Refresh the game list
                    fetchGames();
                })
                .catch(function(error) {
                    console.error("Error writing document: ", error);
                });
            });

            // Fetch games on initial page load
            fetchGames();
        });
    </script>
</body>
</html>